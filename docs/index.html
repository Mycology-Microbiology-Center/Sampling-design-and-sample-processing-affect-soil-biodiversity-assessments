<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNA-metabarcoding sequencing calculator</title>
    <!-- Vue.js CDN -->
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.6.14/dist/vuetify.min.css" rel="stylesheet">
    <!-- Material Design Icons (required by Vuetify) -->
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
    <style>
        .message-text {
            white-space: pre-line;
            font-size: 17px;
        }
        .results-table .v-data-table__wrapper table tbody tr td:first-child {
            white-space: pre;
        }
    </style>
</head>
<body>
    <div id="app">
        <v-app>
            <v-container class="px-0 py-0">
                <!-- Custom Hero Section instead of standard app-bar -->
                <a href="https://sisu.ut.ee/mmc/?lang=en" target="_blank" style="text-decoration: none; display: block;">
                    <div class="page-hero" style="background-image: url(https://sisu.ut.ee/wp-content/uploads/sites/474/anigif.gif); height: 200px; background-size: cover; background-position: center; position: relative; cursor: pointer;">
                        <div class="hero-overlay">
                        </div>
                    </div>
                </a>
            </v-container>

            <v-main>
                <v-container class="px-2">
                    <!-- App Title Section -->
                    <v-row class="mb-4">
                        <v-col cols="12" class="text-center">
                            <h1 class="display-1 font-weight-light primary--text mb-2">
                                DNA-metabarcoding sequencing calculator
                            </h1>
                            <p class="subtitle-1 grey--text mb-2">
                                Optimize your experimental design and estimate costs for soil biodiversity assessments
                            </p>
                            <v-chip color="orange" text-color="white" small>
                                <v-icon left small>mdi-flask-outline</v-icon>
                                Beta Version
                            </v-chip>
                        </v-col>
                    </v-row>
                    
                    <v-row>
                        <v-col cols="12">
                            <!-- Overall settings card (experimental design, costs, sequencing parameters) -->
                            <v-card class="mb-4" elevation="2">
                                <v-card-title class="primary white--text">
                                    <v-icon class="mr-2" color="white">mdi-flask-outline</v-icon>
                                    Experimental Design
                                </v-card-title>
                                <v-card-text class="pt-4">
                                    <v-form>
                                        <v-row>
                                            <!-- Experimental design -->
                                            <v-col cols="12">
                                                <div class="d-flex align-center">
                                                    <v-select
                                                  v-model="selectedObject"
                                                  :items="['Bacteria', 'Fungi', 'Animal']"
                                                  label="Taxonomic group of interest"
                                                  outlined
                                                  class="flex-grow-1"
                                                  @change="onObjectChange"
                                                ></v-select>
                                                    <v-tooltip bottom>
                                                        <template v-slot:activator="{ on, attrs }">
                                                            <v-icon
                                                                color="grey"
                                                                dark
                                                                v-bind="attrs"
                                                                v-on="on"
                                                                class="ml-2"
                                                            >
                                                                mdi-information-outline
                                                            </v-icon>
                                                        </template>
                                                        <span>Used when calculating the pooling effectâ€”the impact of sample pooling on biodiversity estimates.</span>
                                                    </v-tooltip>
                                                </div>
                                            </v-col>
                                            <v-col cols="12" md="4">
                                                <div class="d-flex align-center">
                                                    <v-text-field
                                                        v-model.number="numSites"
                                                        label="Number of sampling sites"
                                                        type="number"
                                                        outlined
                                                        min="1"
                                                        :rules="[v => v >= 1 || 'Value must be greater than or equal to 1']"
                                                        class="flex-grow-1"
                                                    ></v-text-field>
                                                    <v-tooltip bottom>
                                                        <template v-slot:activator="{ on, attrs }">
                                                            <v-icon
                                                                color="grey"
                                                                dark
                                                                v-bind="attrs"
                                                                v-on="on"
                                                                class="ml-2"
                                                            >
                                                                mdi-information-outline
                                                            </v-icon>
                                                        </template>
                                                        <span>The number of distinct geographical or environmental locations being sampled</span>
                                                    </v-tooltip>
                                                </div>
                                            </v-col>
                                            <v-col cols="12" md="4">
                                                <div class="d-flex align-center">
                                                    <v-text-field
                                                        v-model.number="numSamples"
                                                        label="Number of individual samples per site"
                                                        type="number"
                                                        outlined
                                                        min="1"
                                                        :rules="[v => v >= 1 || 'Value must be greater than or equal to 1']"
                                                        class="flex-grow-1"
                                                    ></v-text-field>
                                                    <v-tooltip bottom>
                                                        <template v-slot:activator="{ on, attrs }">
                                                            <v-icon
                                                                color="grey"
                                                                dark
                                                                v-bind="attrs"
                                                                v-on="on"
                                                                class="ml-2"
                                                            >
                                                                mdi-information-outline
                                                            </v-icon>
                                                        </template>
                                                        <span>The number of individual samples collected at each site</span>
                                                    </v-tooltip>
                                                </div>
                                            </v-col>
                                            <v-col cols="12" md="4">
                                                <div class="d-flex align-center">
                                                    <v-text-field
                                                        v-model.number="numSemipools"
                                                        label="Number of semipools per site"
                                                        type="number"
                                                        outlined
                                                        min="1"
                                                        class="flex-grow-1"
                                                    ></v-text-field>
                                                    <v-tooltip bottom>
                                                        <template v-slot:activator="{ on, attrs }">
                                                            <v-icon
                                                                color="grey"
                                                                dark
                                                                v-bind="attrs"
                                                                v-on="on"
                                                                class="ml-2"
                                                            >
                                                                mdi-information-outline
                                                            </v-icon>
                                                        </template>
                                                        <span>The number of samples pooled into each pool or the total number of pools each site when using semi-pooled approach</span>
                                                    </v-tooltip>
                                                </div>
                                                
                                                <!-- Semipool balance warning -->
                                                <v-alert
                                                    v-if="numSemipools > 0 && numSamples > 0"
                                                    :type="semipoolBalance.isBalanced ? 'info' : 'warning'"
                                                    dense
                                                    text
                                                    class="mt-1"
                                                >
                                                {{ semipoolBalance.message }}
                                                </v-alert>


                                            </v-col>

                                            <!-- Costs Section -->
                                            <v-col cols="12">
                                                <v-divider class="my-6"></v-divider>
                                                <div class="d-flex align-center mb-4">
                                                    <v-icon class="mr-2" color="success">mdi-cash-multiple</v-icon>
                                                    <h3 class="text-h5 success--text mb-0">Costs</h3>
                                                </div>
                                                    <v-row>
                                                        <v-col cols="12" md="4">
                                                            <div class="d-flex align-center">
                                                                <v-text-field
                                                                    v-model.number="dnaExtractionCost"
                                                                    label="DNA extraction costs (per sample)"
                                                                    type="number"
                                                                    outlined
                                                                    prepend-inner-icon="mdi-cash-multiple"
                                                                    min="0"
                                                                    :rules="[v => v >= 0 || 'Value must be greater than or equal to 0']"
                                                                    class="flex-grow-1"
                                                                ></v-text-field>
                                                                <v-tooltip bottom>
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            class="ml-2"
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>The cost per sample for DNA extraction, including reagents, consumables, and labor.</span>
                                                                </v-tooltip>
                                                            </div>
                                                        </v-col>
                                                        <v-col cols="12" md="4">
                                                            <div class="d-flex align-center">
                                                                <v-text-field
                                                                    v-model.number="pcrCost"
                                                                    label="Library prep & PCR costs (per sample)"
                                                                    type="number"
                                                                    outlined
                                                                    prepend-inner-icon="mdi-cash-multiple"
                                                                    min="0"
                                                                    :rules="[v => v >= 0 || 'Value must be greater than or equal to 0']"
                                                                    class="flex-grow-1"
                                                                ></v-text-field>
                                                                <v-tooltip bottom>
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            class="ml-2"
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>Cost of PCR amplification, indexing/adapter ligation, clean-up, and QC needed to create a sequencing-ready library from one sample.</span>
                                                                </v-tooltip>
                                                            </div>
                                                        </v-col>
                                                        <v-col cols="12" md="4">
                                                            <div class="d-flex align-center">
                                                                <v-text-field
                                                                    v-model.number="librarySequencingCost"
                                                                    label="Sequencing costs (per run)"
                                                                    type="number"
                                                                    outlined
                                                                    prepend-inner-icon="mdi-cash-multiple"
                                                                    min="0"
                                                                    :rules="[v => v >= 0 || 'Value must be greater than or equal to 0']"
                                                                    class="flex-grow-1"
                                                                ></v-text-field>
                                                                <v-tooltip bottom>
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            class="ml-2"
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>Total reagent + flow-cell cost for a single sequencing run (e.g., one Illumina lane, PacBio SMRT Cell, or ONT flow cell), regardless of how many libraries are pooled.</span>
                                                                </v-tooltip>
                                                            </div>
                                                        </v-col>
                                                    </v-row>
                                            </v-col>

                                            <!-- Sequencing Section -->
                                            <v-col cols="12">
                                                <v-divider class="my-6"></v-divider>
                                                <div class="d-flex align-center mb-4">
                                                    <v-icon class="mr-2" color="info">mdi-dna</v-icon>
                                                    <h3 class="text-h5 info--text mb-0">Sequencing Parameters</h3>
                                                </div>
                                                    <v-row>
                                                        <v-col cols="12" md="6">
                                                            <div class="d-flex align-center">
                                                                <v-card outlined class="pa-3 flex-grow-1">
                                                                    <div class="d-flex align-center">
                                                                        <div class="text-subtitle-2 mb-2">Required number of reads per individual sample</div>
                                                                        <v-tooltip bottom>
                                                                            <template v-slot:activator="{ on, attrs }">
                                                                                <v-icon
                                                                                    color="grey"
                                                                                    dark
                                                                                    v-bind="attrs"
                                                                                    v-on="on"
                                                                                    class="ml-2"
                                                                                    small
                                                                                >
                                                                                    mdi-information-outline
                                                                                </v-icon>
                                                                            </template>
                                                                            <span>The target number of sequencing reads per individual sample needed for adequate coverage (applied to unpooled sampling).</span>
                                                                        </v-tooltip>
                                                                    </div>
                                                                    <v-row align="center" no-gutters>
                                                                        <v-col cols="8">
                                                                            <v-slider
                                                                                v-model="requiredReads"
                                                                                min="50"
                                                                                max="200000"
                                                                                step="50"
                                                                                thumb-label
                                                                                :thumb-size="50"
                                                                                track-color="grey lighten-2"
                                                                                thumb-color="primary"
                                                                                hide-details
                                                                                class="align-center"
                                                                            ></v-slider>
                                                                        </v-col>
                                                                        <v-col cols="4" class="pl-3">
                                                                            <v-text-field
                                                                                v-model.number="requiredReads"
                                                                                type="number"
                                                                                min="50"
                                                                                max="100000"
                                                                                step="50"
                                                                                density="compact"
                                                                                hide-details
                                                                                outlined
                                                                                class="mt-0 pt-0"
                                                                                style="max-width: 120px;"
                                                                            ></v-text-field>
                                                                        </v-col>
                                                                    </v-row>
                                                                    <div class="text-caption grey--text mt-1">
                                                                        Typically 5,000-50,000 for amplicon sequencing
                                                                    </div>
                                                                    
                                                                    <!-- Quality Control Loss Rate -->
                                                                    <div class="d-flex align-center">
                                                                        <div class="text-subtitle-2 mt-4 mb-2">Read loss during quality control (%)</div>
                                                                        <v-tooltip bottom>
                                                                            <template v-slot:activator="{ on, attrs }">
                                                                                <v-icon
                                                                                    color="grey"
                                                                                    dark
                                                                                    v-bind="attrs"
                                                                                    v-on="on"
                                                                                    class="ml-2"
                                                                                    small
                                                                                >
                                                                                    mdi-information-outline
                                                                                </v-icon>
                                                                            </template>
                                                                            <span>Accounts for reads lost during bioinformatic processing steps including quality filtering, chimera removal, non-target amplicon filtering, and denoising.</span>
                                                                        </v-tooltip>
                                                                    </div>
                                                                    <v-row align="center" no-gutters>
                                                                        <v-col cols="8">
                                                                            <v-slider
                                                                                v-model="qualityControlLossRate"
                                                                                min="0"
                                                                                max="80"
                                                                                step="1"
                                                                                thumb-label
                                                                                :thumb-size="50"
                                                                                track-color="grey lighten-2"
                                                                                thumb-color="primary"
                                                                                hide-details
                                                                                class="align-center"
                                                                            ></v-slider>
                                                                        </v-col>
                                                                        <v-col cols="4" class="pl-3">
                                                                            <v-text-field
                                                                                v-model.number="qualityControlLossRate"
                                                                                type="number"
                                                                                min="0"
                                                                                max="80"
                                                                                step="1"
                                                                                suffix="%"
                                                                                density="compact"
                                                                                hide-details
                                                                                outlined
                                                                                class="mt-0 pt-0"
                                                                                style="max-width: 120px;"
                                                                            ></v-text-field>
                                                                        </v-col>
                                                                    </v-row>
                                                                    <div class="text-caption grey--text mt-1">
                                                                        Expected percentage of reads lost during bioinformatic processing (typically 30-60% for metabarcoding)
                                                                    </div>
                                                                </v-card>
                                                            </div>
                                                            
                                                            <!-- Sequencing Capacity Information -->
                                                            <v-card 
                                                                outlined 
                                                                class="mt-3 pa-3" 
                                                                v-if="sequencingThroughput && requiredReads"
                                                                color="blue lighten-5"
                                                            >
                                                                <div class="text-subtitle-2 mb-2" style="color: #1976d2;">
                                                                    ðŸ“Š Sequencing capacity analysis
                                                                </div>
                                                                <div class="text-body-2">
                                                                    <v-row no-gutters class="mb-2">
                                                                        <v-col cols="6" class="font-weight-medium"></v-col>
                                                                        <v-col cols="2" class="text-center font-weight-medium">Individual</v-col>
                                                                        <v-col cols="2" class="text-center font-weight-medium">Pooled</v-col>
                                                                        <v-col cols="2" class="text-center font-weight-medium">Semipools</v-col>
                                                                    </v-row>
                                                                    
                                                                    <v-row no-gutters class="mb-1">
                                                                        <v-col cols="6" class="font-weight-medium">Sequencing units per run:</v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.unpooled.currentSamples > sequencingCapacity.unpooled.maxSamples ? 'orange--text font-weight-bold' : ''">
                                                                                {{ sequencingCapacity.unpooled.currentSamples.toLocaleString() }}
                                                                            </span>
                                                                        </v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.pooled.currentSamples > sequencingCapacity.pooled.maxSamples ? 'orange--text font-weight-bold' : ''">
                                                                                {{ sequencingCapacity.pooled.currentSamples.toLocaleString() }}
                                                                            </span>
                                                                        </v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.semiPooled.currentSamples > sequencingCapacity.semiPooled.maxSamples ? 'orange--text font-weight-bold' : ''">
                                                                                {{ sequencingCapacity.semiPooled.currentSamples.toLocaleString() }}
                                                                            </span>
                                                                        </v-col>
                                                                    </v-row>
                                                                    
                                                                    <v-row no-gutters class="mb-1">
                                                                        <v-col cols="6" class="font-weight-medium">Max platform capacity:</v-col>
                                                                        <v-col cols="2" class="text-center">{{ sequencingCapacity.unpooled.maxSamples.toLocaleString() }}</v-col>
                                                                        <v-col cols="2" class="text-center">{{ sequencingCapacity.pooled.maxSamples.toLocaleString() }}</v-col>
                                                                        <v-col cols="2" class="text-center">{{ sequencingCapacity.semiPooled.maxSamples.toLocaleString() }}</v-col>
                                                                    </v-row>
                                                                    
                                                                    <v-row no-gutters class="mb-1">
                                                                        <v-col cols="6" class="font-weight-medium">Remaining capacity:</v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.unpooled.remainingCapacity <= 0 ? 'orange--text font-weight-bold' : 'green--text'">
                                                                                {{ sequencingCapacity.unpooled.remainingCapacity.toLocaleString() }}
                                                                            </span>
                                                                        </v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.pooled.remainingCapacity <= 0 ? 'orange--text font-weight-bold' : 'green--text'">
                                                                                {{ sequencingCapacity.pooled.remainingCapacity.toLocaleString() }}
                                                                            </span>
                                                                        </v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.semiPooled.remainingCapacity <= 0 ? 'orange--text font-weight-bold' : 'green--text'">
                                                                                {{ sequencingCapacity.semiPooled.remainingCapacity.toLocaleString() }}
                                                                            </span>
                                                                        </v-col>
                                                                    </v-row>
                                                                    
                                                                    <v-row no-gutters class="mb-2">
                                                                        <v-col cols="6" class="font-weight-medium">Platform utilization:</v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.unpooled.utilizationPercent > 100 ? 'orange--text font-weight-bold' : ''">
                                                                                {{ sequencingCapacity.unpooled.utilizationPercent }}%
                                                                            </span>
                                                                        </v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.pooled.utilizationPercent > 100 ? 'orange--text font-weight-bold' : ''">
                                                                                {{ sequencingCapacity.pooled.utilizationPercent }}%
                                                                            </span>
                                                                        </v-col>
                                                                        <v-col cols="2" class="text-center">
                                                                            <span :class="sequencingCapacity.semiPooled.utilizationPercent > 100 ? 'orange--text font-weight-bold' : ''">
                                                                                {{ sequencingCapacity.semiPooled.utilizationPercent }}%
                                                                            </span>
                                                                        </v-col>
                                                                    </v-row>
                                                                </div>
                                                                <div class="text-caption grey--text">
                                                                    <br>
                                                                    <strong>Orange values:</strong> Exceed platform capacity and require multiple runs
                                                                </div>
                                                            </v-card>
                                                        </v-col>
                                                        <v-col cols="12" md="6">
                                                            <div class="d-flex align-center">
                                                                <v-card outlined class="pa-3 flex-grow-1">
                                                                    <div class="d-flex align-center">
                                                                        <div class="text-subtitle-2 mb-2">Pooling factor</div>
                                                                        <v-tooltip bottom>
                                                                            <template v-slot:activator="{ on, attrs }">
                                                                                <v-icon
                                                                                    color="grey"
                                                                                    dark
                                                                                    v-bind="attrs"
                                                                                    v-on="on"
                                                                                    class="ml-2"
                                                                                    small
                                                                                >
                                                                                    mdi-information-outline
                                                                                </v-icon>
                                                                            </template>
                                                                            <span>Pooling effect describes the difference between pooled samples and individual samples in their ability to estimate within-site diversity. As shown by Chen et al., 2025, pooling effect varies across taxa of interest and depends on the number of pooled individual samples (recommended not to exceed 9) and the number of reads allocated to the pooled sample compared to the total read counts of individual samples.</span>
                                                                        </v-tooltip>
                                                                    </div>
                                                                    <v-row align="center" no-gutters>
                                                                        <v-col cols="8">
                                                                            <v-slider
                                                                                v-model="poolingFactor"
                                                                                min="0"
                                                                                max="10"
                                                                                step="0.01"
                                                                                thumb-label
                                                                                :thumb-size="50"
                                                                                track-color="grey lighten-2"
                                                                                thumb-color="primary"
                                                                                hide-details
                                                                                class="align-center"
                                                                            ></v-slider>
                                                                        </v-col>
                                                                        <v-col cols="4" class="pl-3">
                                                                            <v-text-field
                                                                                v-model.number="poolingFactor"
                                                                                type="number"
                                                                                min="0"
                                                                                max="10"
                                                                                step="0.01"
                                                                                density="compact"
                                                                                hide-details
                                                                                outlined
                                                                                class="mt-0 pt-0"
                                                                                style="max-width: 120px;"
                                                                            ></v-text-field>
                                                                        </v-col>
                                                                    </v-row>
                                                                                                                                                                                            <div class="text-caption grey--text mt-1">
                                                                        Pooling factor is ratio of the pooled sample's read count to the total reads across the individual samples
                                                                    </div>
                                                    
                                                    <!-- Calculated read numbers -->
                                                    <v-row class="mt-3" no-gutters>
                                                        <v-col cols="6" class="pr-1">
                                                            <div class="d-flex align-center">
                                                                <v-text-field
                                                                    :value="Math.round(requiredReads * poolingFactor * numSamples).toLocaleString()"
                                                                    label="Reads per pooled sample"
                                                                    type="text"
                                                                    outlined
                                                                    readonly
                                                                    dense
                                                                    hide-details
                                                                    class="flex-grow-1"
                                                                ></v-text-field>
                                                                <v-tooltip bottom>
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            class="ml-1"
                                                                            small
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>Number of reads assigned to each pooled sample at the selected pooling factor.</span>
                                                                </v-tooltip>
                                                            </div>
                                                            
                                                            <!-- Pooling effect warning for pooled samples -->
                                                            <v-alert
                                                                v-if="pooledSamplePoolingEffect.isNotSelected"
                                                                color="grey lighten-2"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Please select taxonomic group.
                                                            </v-alert>

                                                            <v-alert
                                                                v-else-if="pooledSamplePoolingEffect.isPositive"
                                                                color="green"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Pooling effect is positive.
                                                            </v-alert>

                                                            <v-alert
                                                                v-else-if="pooledSamplePoolingEffect.isNegative"
                                                                color="orange lighten-2"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Pooling effect is negative.
                                                            </v-alert>

                                                            <v-alert
                                                                v-else-if="pooledSamplePoolingEffect.isUnknown"
                                                                color="orange lighten-2"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Pooling effect is unknown (>100 samples per site).
                                                            </v-alert>
                                                        </v-col>
                                                        <v-col cols="6" class="pl-1">
                                                            <div class="d-flex align-center">
                                                                <v-text-field
                                                                    :value="numSemipools > 0 ? Math.round(requiredReads * numSamples * poolingFactor / numSemipools).toLocaleString() : '0'"
                                                                    label="Reads per each semipool"
                                                                    type="text"
                                                                    outlined
                                                                    readonly
                                                                    dense
                                                                    hide-details
                                                                    class="flex-grow-1"
                                                                ></v-text-field>
                                                                <v-tooltip bottom>
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            class="ml-1"
                                                                            small
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>Number of reads assigned to each semipool at the selected pooling factor.</span>
                                                                </v-tooltip>
                                                            </div>
                                                            
                                                            <!-- Pooling effect warning for semipools -->
                                                            <v-alert
                                                                v-if="semipoolPoolingEffect.isNotSelected"
                                                                color="grey lighten-2"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Please select taxonomic group.
                                                            </v-alert>

                                                            <v-alert
                                                                v-else-if="semipoolPoolingEffect.isPositive"
                                                                color="green"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Pooling effect is positive.
                                                            </v-alert>

                                                            <v-alert
                                                                v-else-if="semipoolPoolingEffect.isNegative"
                                                                color="orange lighten-2"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Pooling effect is negative.
                                                            </v-alert>

                                                            <v-alert
                                                                v-else-if="semipoolPoolingEffect.isUnknown"
                                                                color="orange lighten-2"
                                                                dense
                                                                text
                                                                class="mt-2"
                                                                icon=""
                                                            >
                                                                Pooling effect is unknown (>100 samples per site).
                                                            </v-alert>
                                                        </v-col>
                                                    </v-row>
                                                </v-card>
                                                                <v-tooltip bottom>
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            class="ml-2"
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>Ratio of sequencing reads given to one pooled sample versus the combined reads that would have been allocated to the individual samples it replaces. Example: 4 individual samples, with each getting 1000 reads, have 4000 reads in total for assessing biodiversity within a site. With a pooling factor of 0.5, the pooled sample has 2 000 reads, with a pooling factor of 5, it has 20 000 reads.</span>
                                                                </v-tooltip>
                                                            </div>

                                                            </v-col>
                                                        <v-col cols="12" md="6">
                                                            <div class="d-flex align-center">
                                                                <v-select
                                                                    v-model="sequencingPlatform"
                                                                    :items="platforms"
                                                                    label="Sequencing platform"
                                                                    outlined
                                                                    class="flex-grow-1"
                                                                ></v-select>
                                                                <v-tooltip bottom>
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            class="ml-2"
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>The sequencing technology platform that will be used (affects throughput and cost considerations)</span>
                                                                </v-tooltip>
                                                            </div>
                                                        </v-col>
                                                        <v-col cols="12" md="6">
                                                            <div class="d-flex">
                                                                <v-text-field
                                                                    v-model.number="sequencingThroughput"
                                                                    label="Sequencing throughput (reads per run)"
                                                                    type="number"
                                                                    outlined
                                                                    min="0"
                                                                    :rules="[v => v >= 0 || 'Value must be greater than or equal to 0']"
                                                                    @input="onThroughputInput"
                                                                    class="flex-grow-1"
                                                                ></v-text-field>
                                                                <v-tooltip bottom class="ml-2 mt-3">
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-icon
                                                                            color="grey"
                                                                            dark
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                        >
                                                                            mdi-information-outline
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>The total number of sequencing reads produced in a single run by the selected platform (automatically set based on platform, but can be manually adjusted)</span>
                                                                </v-tooltip>
                                                                <v-btn
                                                                    icon
                                                                    class="mt-3 ml-2"
                                                                    title="Reset to platform default"
                                                                    @click="resetThroughputOverride"
                                                                    :disabled="!sequencingPlatform"
                                                                >
                                                                    <v-icon>mdi-refresh</v-icon>
                                                                </v-btn>
                                                            </div>
                                                            <div class="caption grey--text" v-if="sequencingPlatform">
                                                                Default for {{ sequencingPlatform }}: {{ platformThroughputs[sequencingPlatform].toLocaleString() }} reads
                                                            </div>
                                                        </v-col>
                                                    </v-row>
                                            </v-col>
                                        </v-row>
                    </v-form>
                                </v-card-text>
                            </v-card>
                            
                            <!-- Results Section -->
                            <v-card v-if="isValidConfiguration" class="mt-4" elevation="2">
                                <v-card-title class="warning white--text">
                                    <v-icon class="mr-2" color="white">mdi-calculator</v-icon>
                                    Results
                                </v-card-title>
                                <v-card-text class="pa-0">
                                    <v-data-table
                                        :headers="resultHeaders"
                                        :items="calculatedResults"
                                        hide-default-footer
                                        disable-sort
                                        class="results-table"
                                    ></v-data-table>
                                </v-card-text>
                            </v-card>
                        </v-col>
                    </v-row>
                </v-container>
                
                <!-- Citation Section -->
                <v-container class="px-2 py-6">
                    <v-row>
                        <v-col cols="12">
                            <v-card outlined class="pa-4" color="grey lighten-4">
                                <v-card-title class="text-h6 pb-2">
                                    <v-icon class="mr-2" color="grey darken-1">mdi-book-open-variant</v-icon>
                                    Citation
                                </v-card-title>
                                <v-card-text class="pt-0">
                                    <p class="body-1 mb-0" style="font-style: italic;">
                                        Chen M, Dulya O, Mikryukov V, Copot O, Metsoja M, Tedersoo L. (under review). Sampling design and sample processing affect soil biodiversity assessments.
                                    </p>
                                </v-card-text>
                            </v-card>
                        </v-col>
                    </v-row>
                </v-container>
            </v-main>

            <v-footer app>
                <span>&copy; {{ new Date().getFullYear() }} <a href="https://sisu.ut.ee/mmc/?lang=en" target="_blank" style="color: inherit; text-decoration: none;">Mycology and Microbiology Center</a></span>
            </v-footer>
        </v-app>
    </div>

    <!-- Vue.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <!-- Vuetify CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.6.14/dist/vuetify.js"></script>
    <!-- Your JS -->
    <script src="script.js"></script>
</body>
</html>
